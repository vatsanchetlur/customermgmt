{"ast":null,"code":"// filepath: /Users/n0096336/Downloads/FullStack/capstone2/customer-management-app/src/services/customerService.js\n// LocalStorage key for customer data persistence\nconst STORAGE_KEY = 'customer-management-data';\n\n// Helper to check if we've already initialized localStorage\nconst isInitialized = () => {\n  return localStorage.getItem(STORAGE_KEY) !== null;\n};\n\n// Initialize from JSON file if needed\nconst initializeFromJson = async () => {\n  try {\n    console.log('Initializing from JSON file...');\n    // Try multiple paths to handle different deployment scenarios\n    let response;\n    try {\n      // First try with the base URL\n      response = await fetch('/data/customers.json');\n      if (!response.ok) throw new Error('Not found at root path');\n    } catch (error) {\n      console.log('Trying alternate path...');\n      // If that fails, try with relative path\n      response = await fetch('./data/customers.json');\n    }\n    if (!response.ok) {\n      console.error(`Error fetching JSON: ${response.status} ${response.statusText}`);\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    const initialData = await response.json();\n    console.log('Initial data loaded:', initialData);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(initialData));\n    return initialData;\n  } catch (error) {\n    console.error(\"Failed to load initial data:\", error);\n    // Fallback to hardcoded data if JSON file can't be loaded\n    const fallbackData = [{\n      id: 1,\n      name: 'Mike Johnson',\n      email: 'mikej@abc.com',\n      password: 'mikej'\n    }, {\n      id: 2,\n      name: 'Cindy Smith',\n      email: 'cinds@abc.com',\n      password: 'cinds'\n    }, {\n      id: 3,\n      name: 'Julio Martin',\n      email: 'julim@abc.com',\n      password: 'julim'\n    }];\n    console.log('Using fallback data:', fallbackData);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(fallbackData));\n    return fallbackData;\n  }\n};\nexport const getCustomers = async () => {\n  try {\n    // If not initialized, load from JSON file\n    if (!isInitialized()) {\n      console.log('LocalStorage not initialized, loading from JSON...');\n      return await initializeFromJson();\n    }\n\n    // Otherwise get from localStorage\n    console.log('Loading from localStorage');\n    const data = localStorage.getItem(STORAGE_KEY);\n    const parsedData = JSON.parse(data) || [];\n    console.log('Loaded customers:', parsedData);\n    return parsedData;\n  } catch (error) {\n    console.error(\"Failed to fetch customers:\", error);\n    return []; // Return empty array on error\n  }\n};\nexport const addCustomer = async customer => {\n  try {\n    // Get current customers\n    const currentCustomers = await getCustomers();\n\n    // Generate a new ID (max + 1)\n    const nextId = currentCustomers.length > 0 ? Math.max(...currentCustomers.map(c => c.id)) + 1 : 1;\n\n    // Create new customer with ID\n    const newCustomer = {\n      id: nextId,\n      ...customer\n    };\n\n    // Add to list and save\n    const updatedCustomers = [...currentCustomers, newCustomer];\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedCustomers));\n    return newCustomer;\n  } catch (error) {\n    console.error(\"Failed to add customer:\", error);\n    throw error;\n  }\n};\nexport const updateCustomer = async (id, updatedData) => {\n  try {\n    const customers = await getCustomers();\n    const index = customers.findIndex(c => c.id === id);\n    if (index === -1) {\n      throw new Error(`Customer with ID ${id} not found`);\n    }\n\n    // Update the customer\n    const updatedCustomer = {\n      ...customers[index],\n      ...updatedData\n    };\n    customers[index] = updatedCustomer;\n\n    // Save to localStorage\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(customers));\n    return updatedCustomer;\n  } catch (error) {\n    console.error(`Failed to update customer ${id}:`, error);\n    throw error;\n  }\n};\nexport const deleteCustomer = async id => {\n  try {\n    const customers = await getCustomers();\n    const filteredCustomers = customers.filter(c => c.id !== id);\n    if (filteredCustomers.length === customers.length) {\n      throw new Error(`Customer with ID ${id} not found`);\n    }\n\n    // Save filtered list\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(filteredCustomers));\n    return {\n      message: 'Customer deleted successfully'\n    };\n  } catch (error) {\n    console.error(`Failed to delete customer ${id}:`, error);\n    throw error;\n  }\n};","map":{"version":3,"names":["STORAGE_KEY","isInitialized","localStorage","getItem","initializeFromJson","console","log","response","fetch","ok","Error","error","status","statusText","initialData","json","setItem","JSON","stringify","fallbackData","id","name","email","password","getCustomers","data","parsedData","parse","addCustomer","customer","currentCustomers","nextId","length","Math","max","map","c","newCustomer","updatedCustomers","updateCustomer","updatedData","customers","index","findIndex","updatedCustomer","deleteCustomer","filteredCustomers","filter","message"],"sources":["/Users/n0096336/Downloads/FullStack/capstone2/customer-management-app/src/services/customerService.js"],"sourcesContent":["// filepath: /Users/n0096336/Downloads/FullStack/capstone2/customer-management-app/src/services/customerService.js\n// LocalStorage key for customer data persistence\nconst STORAGE_KEY = 'customer-management-data';\n\n// Helper to check if we've already initialized localStorage\nconst isInitialized = () => {\n    return localStorage.getItem(STORAGE_KEY) !== null;\n};\n\n// Initialize from JSON file if needed\nconst initializeFromJson = async () => {\n    try {\n        console.log('Initializing from JSON file...');\n        // Try multiple paths to handle different deployment scenarios\n        let response;\n        try {\n            // First try with the base URL\n            response = await fetch('/data/customers.json');\n            if (!response.ok) throw new Error('Not found at root path');\n        } catch (error) {\n            console.log('Trying alternate path...');\n            // If that fails, try with relative path\n            response = await fetch('./data/customers.json');\n        }\n        \n        if (!response.ok) {\n            console.error(`Error fetching JSON: ${response.status} ${response.statusText}`);\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const initialData = await response.json();\n        console.log('Initial data loaded:', initialData);\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(initialData));\n        return initialData;\n    } catch (error) {\n        console.error(\"Failed to load initial data:\", error);\n        // Fallback to hardcoded data if JSON file can't be loaded\n        const fallbackData = [\n            { id: 1, name: 'Mike Johnson', email: 'mikej@abc.com', password: 'mikej' },\n            { id: 2, name: 'Cindy Smith', email: 'cinds@abc.com', password: 'cinds' },\n            { id: 3, name: 'Julio Martin', email: 'julim@abc.com', password: 'julim' }\n        ];\n        console.log('Using fallback data:', fallbackData);\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(fallbackData));\n        return fallbackData;\n    }\n};\n\nexport const getCustomers = async () => {\n    try {\n        // If not initialized, load from JSON file\n        if (!isInitialized()) {\n            console.log('LocalStorage not initialized, loading from JSON...');\n            return await initializeFromJson();\n        }\n        \n        // Otherwise get from localStorage\n        console.log('Loading from localStorage');\n        const data = localStorage.getItem(STORAGE_KEY);\n        const parsedData = JSON.parse(data) || [];\n        console.log('Loaded customers:', parsedData);\n        return parsedData;\n    } catch (error) {\n        console.error(\"Failed to fetch customers:\", error);\n        return []; // Return empty array on error\n    }\n};\n\nexport const addCustomer = async (customer) => {\n    try {\n        // Get current customers\n        const currentCustomers = await getCustomers();\n        \n        // Generate a new ID (max + 1)\n        const nextId = currentCustomers.length > 0 \n            ? Math.max(...currentCustomers.map(c => c.id)) + 1 \n            : 1;\n        \n        // Create new customer with ID\n        const newCustomer = { \n            id: nextId,\n            ...customer \n        };\n        \n        // Add to list and save\n        const updatedCustomers = [...currentCustomers, newCustomer];\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedCustomers));\n        \n        return newCustomer;\n    } catch (error) {\n        console.error(\"Failed to add customer:\", error);\n        throw error;\n    }\n};\n\nexport const updateCustomer = async (id, updatedData) => {\n    try {\n        const customers = await getCustomers();\n        const index = customers.findIndex(c => c.id === id);\n        \n        if (index === -1) {\n            throw new Error(`Customer with ID ${id} not found`);\n        }\n        \n        // Update the customer\n        const updatedCustomer = { \n            ...customers[index], \n            ...updatedData \n        };\n        customers[index] = updatedCustomer;\n        \n        // Save to localStorage\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(customers));\n        \n        return updatedCustomer;\n    } catch (error) {\n        console.error(`Failed to update customer ${id}:`, error);\n        throw error;\n    }\n};\n\nexport const deleteCustomer = async (id) => {\n    try {\n        const customers = await getCustomers();\n        const filteredCustomers = customers.filter(c => c.id !== id);\n        \n        if (filteredCustomers.length === customers.length) {\n            throw new Error(`Customer with ID ${id} not found`);\n        }\n        \n        // Save filtered list\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(filteredCustomers));\n        \n        return { message: 'Customer deleted successfully' };\n    } catch (error) {\n        console.error(`Failed to delete customer ${id}:`, error);\n        throw error;\n    }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}